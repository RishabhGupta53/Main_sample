data "azurerm_network_interface" "vm_nics" {
  for_each = {
    for gw_key, gw in var.AppGateway :
    for pool_key, vms in gw.backend_pools_vm :
    for vm in vms :
    "${gw_key}_${pool_key}_${vm}" => {
      name                = gw.backend_vm_nic
      resource_group_name = gw.backend_vm_rg
    }
  }

  name                = each.value.name
  resource_group_name = each.value.resource_group_name
}
data "azurerm_app_service" "app_services" {
  for_each = {
    for gw_key, gw in var.AppGateway :
    for pool_key, apps in gw.backend_pools_appservice :
    for app in apps :
    "${gw_key}_${pool_key}_${app}" => {
      name                = app
      resource_group_name = gw.backend_app_service_rg
    }
  }

  name                = each.value.name
  resource_group_name = each.value.resource_group_name
}
