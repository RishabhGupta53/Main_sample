data "azurerm_app_service" "app_services" {
  for_each = {
    for gw_key, gw in var.AppGateway : 
      for app_pool_key, app_names in gw.backend_pools_appservice : 
        for app in app_names : {
          key   = "${gw_key}_${app_pool_key}_${app}"
          name  = app
          rg    = var.resource_group_name
        }
  }

  name                = each.value.name
  resource_group_name = each.value.rg
}
